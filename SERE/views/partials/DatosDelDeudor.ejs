<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitud de caso</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="icon" type="image/x-icon" href="/images/ico.ico">
</head>

<body>
    <div id="header"></div>
    <div class="container text-center">
        
        <%- include('NavSere') %>
        <div class="card mb-3">
            <img src="/images/sere/contrato.jpg" class="card-img-top" alt="..." height="100">
            <div class="card-body">
              <h5 class="card-title">CONTRATO</h5>
              <p class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Illum dolore facilis aut fuga eaque sed molestiae temporibus labore amet, repellendus magnam tempora impedit suscipit modi perferendis recusandae a blanditiis id</p>
            </div>
          </div>
            <h2 class="text-center">Información del Cliente</h2>
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control text-center" id="filtroNumeroCaso"
                            placeholder="Ingrese número de caso">
                        <button class="btn btn-outline-secondary" type="button" id="btnBuscar"><i
                                class="bi bi-search"></i></button>
                    </div>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-striped table-hover" id="clienteTable">
                    <thead class="table-dark">
                        <tr>
                            <th>Número de Caso</th>
                            <th>RFC</th>
                            <th># Cliente Padre</th>
                            <th># Cliente Hijo</th>
                            <th>Razón Social</th>
                            <th>Solicitud</th>
                            <th>Cotizacion</th>
                        </tr>
                    </thead>
                    <tbody id="clienteTableBody">
                        <% data.forEach(cliente=> { %>
                            <tr>
                                <td>
                                    <%= cliente.IDCuenta %>
                                </td>
                                <td>
                                    <%= cliente.RFC %>
                                </td>
                                <td>
                                    <%= cliente.NumeroClientePadre %>
                                </td>
                                <td>
                                    <%= cliente.NumeroClienteHijo %>
                                </td>
                                <td>
                                    <%= cliente.RazonSocial %>
                                </td>
                                <td><a href="/sere/datos?IDCuenta=<%= cliente.IDCuenta %>" class="btn btn-dark">ver</a>
                                </td>
                                <td><a href="/sere/datos1?IDCuenta=<%= cliente.IDCuenta %>"
                                        class="btn btn-secondary">añadir</a></td>
                            </tr>
                            <% }); %>
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="pagination">
                    <!-- Pagination items will be inserted here by JavaScript -->
                </ul>
            </nav>
            <style>
                .pagination .page-link {
                    color: #dc3545;
                    background-color: #ffffff; /* Rojo (danger) */
                    border-color: #dc3545; /* Rojo (danger) */
                }
        
                .pagination .page-link:hover {
                    color: #ffffff;
                    background-color: #ff5654; /* Rojo más oscuro al pasar el mouse */
                    border-color: #bd2130; /* Rojo más oscuro al pasar el mouse */
                }
        
                .pagination .page-item.active .page-link {
                    color: #ffffff;
                    background-color: #E52421; /* Rojo más oscuro para la página activa */
                    border-color: #bd2130; /* Rojo más oscuro para la página activa */
                }
            </style>
    </div>
    <div id="footer"></div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(function () {
            $("#header").load("/header");
            $("#footer").load("/footer");

            // JavaScript para la paginación y filtro
            const rowsPerPage = 15;
            const tableBody = document.getElementById('clienteTableBody');
            const pagination = document.getElementById('pagination');
            const rows = Array.from(tableBody.querySelectorAll('tr'));
            let pageCount = Math.ceil(rows.length / rowsPerPage);
            let currentPage = 1;

            function displayPage(page) {
                const startRow = (page - 1) * rowsPerPage;
                const endRow = startRow + rowsPerPage;

                rows.forEach((row, index) => {
                    row.style.display = (index >= startRow && index < endRow) ? '' : 'none';
                });

                updatePagination();
            }

            function setupPagination() {
                pagination.innerHTML = '';

                for (let i = 1; i <= pageCount; i++) {
                    const li = document.createElement('li');
                    li.className = `page-item ${i === currentPage ? 'active' : ''}`;
                    li.innerHTML = `<a class="page-link" href="#">${i}</a>`;
                    li.setAttribute('data-page', i);
                    li.addEventListener('click', (e) => {
                        e.preventDefault();
                        currentPage = i;
                        displayPage(currentPage);
                    });
                    pagination.appendChild(li);
                }
            }

            function updatePagination() {
                pageCount = Math.ceil(rows.length / rowsPerPage);
                setupPagination();
            }

            displayPage(currentPage);
            setupPagination();

            // Filtro por número de caso
            $('#filtroNumeroCaso').on('input', function () {
                const filtro = this.value.trim().toLowerCase();

                rows.forEach(row => {
                    const numeroCaso = row.querySelector('td:first-child').textContent.trim().toLowerCase();
                    const match = numeroCaso.includes(filtro);

                    row.style.display = match ? '' : 'none';
                });

                currentPage = 1;
                updatePagination();
            });

            // Botón de búsqueda (opcional)
            $('#btnBuscar').click(function () {
                const filtro = $('#filtroNumeroCaso').val().trim().toLowerCase();

                rows.forEach(row => {
                    const numeroCaso = row.querySelector('td:first-child').textContent.trim().toLowerCase();
                    const match = numeroCaso.includes(filtro);

                    row.style.display = match ? '' : 'none';
                });

                currentPage = 1;
                updatePagination();
            });
        });
    </script>
</body>

</html>